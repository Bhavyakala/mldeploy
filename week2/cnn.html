<!DOCTYPE html>
<html>
<head>
	<title>cnn_mnist</title>
</head>
<script src = "https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@latest"></script>
<script src = "https://cdn.jsdelivr.net/npm/@tensorflow/tfjs-vis"></script>
<script lang = "js">
	async function run(){
		model = tf.sequential();

		model.add(tf.layers.conv2d({inputShape: [28 , 28 , 1] ,
			kernelSize: 3 , filters: 8 , activation: 'relu'}));

		model.add(tf.layers.maxPooling2d({poolSize: [2 , 2]}));

		model.add(tf.layers.conv2d({filters:16 ,
			kernelSize:3 ,activation: 'relu'}));

		model.add(tf.layers.maxPooling2d({poolSize: [2,2]}));

		model.add(tf.flatten());

		model.add(tf.layers.dense({units: 128 , activation: 'relu'}));

		model.add(tf.layers.dense({units: 10 , activation: 'softmax'}));

		model.compile(
		{
			optimizer: tf.train.adam(),
			loss: 'categoricalCrossentropy',
			metrics: ['accuracy']
		});

		const metrics = ['loss' , 'val_loss' , 'acc' , 'val_acc'];

		const container = {name: 'Model Training' , styles: {height:'1000px'}};
		const fitCallbacks = tfvis.show.fitCallbacks(container , metrics)

		model.fit(trainXs , trainYs , {
			batchSize: BATCH_SIZE ,
			validationData: [testXs , testYs],
			epochs: 20,
			shuffle: true,
			callbacks: fitCallbacks
		});
	}
</script>
<body>

</body>
</html>